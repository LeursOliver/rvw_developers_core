<iscontent type="text/html" charset="UTF-8" compact="true" />

<iscomment> Make sure this is NOT Production </iscomment>
<isif condition="${dw.system.System.getInstanceType() !== dw.system.System.PRODUCTION_SYSTEM}">

<!-- Output RVW Dev Tools Debug Messages to `window.console` -->
<script type="text/javascript">
(function() {
    var messages = <isprint value="${JSON.stringify(pdict.Debugger).replace(/</g, '&lt;')}" encoding="off" />;

    // Check if we have Debug Messages
    if (typeof messages !== 'undefined' && messages !== '') {
        // Generate Messages to Console
        var generateLogs = function(type) {
            if (messages[type].length > 0) {
                var label = type.charAt(0).toUpperCase() + type.slice(1);
                var colors = {
                    debug: ['color: #98C379; font-weight: bold;', 'color: #999; font-weight: lighter;'],
                    error: ['color: #F44747; font-weight: bold;', 'color: #999; font-weight: lighter;'],
                    fatal: ['color: #F44747; font-weight: bold;', 'color: #999; font-weight: lighter;'],
                    info: ['color: #528BFF; font-weight: bold;', 'color: #999; font-weight: lighter;'],
                    log: ['font-weight: bold;', 'color: #999; font-weight: lighter;'],
                    warn: ['color: orange; font-weight: bold;', 'color: #999; font-weight: lighter;'],
                };

                console.groupCollapsed('SFCC: %c' + label + ' %c(' + messages[type].length + ')', colors[type][0], colors[type][1]);

                for (msg of messages[type]) {
                    console[type](msg.message);
                    console.groupCollapsed('%cSTACK TRACE', 'color: #999; font-weight: lighter;');
                    console.table(msg.stack);
                    console.groupEnd();
                }

                console.groupEnd();
            }
        };

        // Get Log Types
        var types = Object.keys(messages);

        // Output Log Messages by Type
        types.forEach(function(type){
            generateLogs(type);
        });
    }
})();
</script>

</isif>
